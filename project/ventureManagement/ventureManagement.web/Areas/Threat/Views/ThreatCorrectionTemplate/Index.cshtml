@using Ext.Net
@using Ext.Net.MVC

@{
    ViewBag.Title = "整改措施数据库";
    Layout = "~/Views/Shared/_BaseLayout.cshtml";
    var X = Html.X();
}

@section headtag
{
    <script>
    </script>
}

@section menu
{   
    <form id="fileUpload" enctype="multipart/form-data">
        @(X.FormPanel()
            .ID("BasicForm")
            .Width(500)
            .Frame(true)
            .Title("File Upload Form")
            .PaddingSpec("10px 10px 0 10px")
            .FieldDefaults(fd => fd.LabelWidth = 50)
            .Defaults(d => {
                    d.Add(new Parameter("anchor", "95%", ParameterMode.Value));
                    d.Add(new Parameter("allowBlank", "false", ParameterMode.Raw));
                    d.Add(new Parameter("msgTarget", "side", ParameterMode.Value));
            })
            .Items(
                X.TextField()
                    .ID("FileName")
                    .FieldLabel("FileName"),
                
                X.FileUploadField()
                    .ID("FileUploadField")
                    .EmptyText("Select a file")
                    .FieldLabel("FileName")
                    .ButtonText("")
                    .Icon(Icon.ImageAdd)
            )
            .Listeners(l => l.ValidityChange.Handler = "#{SaveButton}.setDisabled(!valid);")
            .Buttons(
                X.Button()
                    .ID("SaveButton")
                    .Text("Save")
                    .Disabled(false)
                    .DirectEvents(de => {
                        de.Click.Url = Url.Action("UploadClick");
                        de.Click.FormID = "fileUpload";
                        de.Click.Before = @"if (!#{BasicForm}.getForm().isValid()) { return false; } 
                            Ext.Msg.wait('Uploading your file...', 'Uploading');";
                        de.Click.Failure = @"Ext.Msg.show({ 
                                title   : 'Error', 
                                msg     : 'Error during uploading', 
                                minWidth: 200, 
                                modal   : true, 
                                icon    : Ext.Msg.ERROR, 
                                buttons : Ext.Msg.OK 
                            });";
                    }),
                
                X.Button()
                    .Text("Reset")
                    .OnClientClick("#{BasicForm}.getForm().reset();")
            )
        )
    </form>
}
		
		