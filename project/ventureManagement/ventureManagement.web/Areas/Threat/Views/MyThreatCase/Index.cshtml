@using Ext.Net
@using Ext.Net.MVC

@{
    ViewBag.Title = "待处理隐患预警";
    Layout = "~/Views/Shared/_BaseLayout.cshtml";
    var X = Html.X();
}

@section headtag
{
    <script>
        
    </script>
}

@section menu
{
    @(
        X.GridPanelForModel()
            .Title("待处理")
            .ID("ThreatGrid")
            .Frame(true)
            .Height(400)
            
            .Plugins(
                    X.FilterHeader()
                )

            .SelectionModel(
                Html.X().RowSelectionModel()
                    .Mode(SelectionMode.Single)
                    .ID("GridSelector")
                    .Listeners(l =>
                    {
                        l.Select.Handler = "App.ThreatCaseDetail.getForm().loadRecord(record);App.ThreatCaseDetailWin.show(this);";
                    })
            )
    )

    @(
        X.Window()
            .ID("ThreatCaseDetailWin")
            .Width(1000)
            .Height(500)
            .Modal(true)
            .AutoRender(false)
            .AutoScroll(true)
            .Maximizable(true)
            //.Hidden(true)
            .AutoShow(true)
            .Loader(X.ComponentLoader()
                .Url(Url.Action("Detail"))
                .Params(new Parameter("threatCaseId", "3"))
                .Mode(LoadMode.Frame)
                .LoadMask(lm => lm.ShowMask = true)
            )
            //.Items(
            //    Html.X().FormPanel()
            //        .ID("ThreatCaseDetail")
            //        .Frame(true)
            //        .Title("详细信息")
            //        .Width(400)
            //        .DefaultAnchor("100%")
            //        .FieldDefaults(d => {
            //            d.LabelAlign = LabelAlign.Right;
            //        }))
            //        .ItemsFrom(b => Html.DisplayForModel("ThreatCase"))
            .Listeners(ls=>ls.BeforeHide.Handler="App.GridSelector.clearSelections();")
    )
}